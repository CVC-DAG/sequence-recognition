{
    "exp_name": "cross_entropy_fast",
    "description": "Using cross entropy to train a two-headed model, higher LR with scheduling",
    "cipher": "Music",
    "wandb_mode": "online",
    "wandb_project": "PROTO_COMREF",
    "dirs": {
        "results_dir": "/home/ptorras/Documents/comref_experiments",
        "base_data_dir": "/home/ptorras/Documents/Datasets/COMREF/PrototypeSamplesCleanup61",
        "splits_file": "splits.json",
        "prm_vocab_data": "vocab.json",
        "sec_vocab_data": "vocab_group.json"
    },
    "data": {
        "target_shape": [800, 128],
        "target_seqlen": 64,
        "aug_pipeline": null,
        "stretch": null,
        "hflip": false,
        "max_length": null
    },
    "model": {
        "model_name": "kang_2head_seq2seq",
        "model_weights": null,
        "loss_function": "cross-entropy",
        "focal_loss_gamma": 2.0,
        "focal_loss_alpha": 0.25,
        "label_smoothing": 0.0,
        "loss_weights": null,
        "primary_loss_weight": 0.8,
        "secondary_loss_weight": 0.2,
        "vgg_type": 19,
        "vgg_bn": true,
        "vgg_pretrain": true,
        "encoder_layers": 4,
        "decoder_layers": 4,
        "hidden_size": 512,
        "attn_filters": 128,
        "attn_kernsize": 7,
        "attn_smoothing": false,
        "prm_embedding_size": 128,
        "prm_output_units": 220,
        "sec_embedding_size": 32,
        "sec_output_units": 9,
        "feed_secondary": true,
        "teacher_rate": 0.0,
        "dropout": 0.5
    },
    "train": {
        "batch_size": 24,
        "device": "cuda",
        "grad_clip": null,
        "max_epochs": 1000,
        "learning_rate": 3e-4,
        "optimizer": "adamw",
        "save_every": 1,
        "eval_every": 1,
        "weight_decay": 0.001,
        "workers": 8,
        "plateau_sched": true,
        "plateau_factor": 0.1,
        "plateau_iters": 2,
        "plateau_thresh": 0.01,
        "plateau_min": 1e-7,
        "warmup_sched": false,
        "warmup_factor": 0.1,
        "warmup_iters": 10000,
        "cosann_sched": false,
        "cosann_t0": 1,
        "cosann_factor": 0.1,
        "cosann_min": 1e-7,
        "max_logging_epochs": 2,
        "logging_threads": 4
    }
}